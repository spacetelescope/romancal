Added matching of injected sources, unit testing, and a regression testing.
